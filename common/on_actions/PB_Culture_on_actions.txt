### Moved to common/scripted_effects/PB_Cultures.txt so that it can be reloaded in game.
on_actions = {
	on_startup = { 
		effect = {
			ENG = { # Don't mind this, scope fix.
				PB_Setup_Cultures = yes
			}
		} 
	}
	on_monthly = { 
		effect = {
			ROOT = { 

				### Conversion/Acceptance stuff

				every_owned_state = {
					limit = {
						has_state_flag = PB_Culture_Convert_In_Progress
						check_variable = { PB_convert_progress = 100 }
					}
					set_temp_variable = { temp_culture = ROOT.PB_main_culture }
    				PB_Cultures_change_culture_of_state = yes
					set_variable = {
						var = PB_convert_progress
						value = 0
					}
					clr_state_flag = PB_Culture_Convert_In_Progress
					add_core_of = ROOT
				}

				every_owned_state = {
					limit = {
						has_state_flag = PB_Culture_Accept_In_Progress
						check_variable = { PB_convert_progress = 100 }
					}
					set_temp_variable = { temp_culture = culture_id }
					ROOT = { 
						PB_Cultures_add_accepted_culture = yes 
					}
					set_variable = {
						var = PB_convert_progress
						value = 0
					}
					clr_state_flag = PB_Culture_Accept_In_Progress
				}

				if = {
					limit = {
						has_idea = PB_Affirmitive_Action
                        any_state = {
							limit = {
								has_state_flag = PB_Culture_Accept_In_Progress
								is_owned_by = ROOT
							}
						}
					}
					every_state = {
						limit = {
							has_state_flag = PB_Culture_Accept_In_Progress
							is_owned_by = ROOT
						}
						add_to_variable = { PB_convert_progress = 9 }
						clamp_variable = {
							var = PB_convert_progress
							min = 0
							max = 100
						} 
					}
				}

				else_if = {
					limit = {
						has_idea = PB_Significant_Autonomy
						any_state = {
							limit = {
								has_state_flag = PB_Culture_Accept_In_Progress
								is_owned_by = ROOT
							}
						}
					}
					every_state = {
						limit = {
							has_state_flag = PB_Culture_Accept_In_Progress
							is_owned_by = ROOT
						}
						add_to_variable = { PB_convert_progress = 6 }
						clamp_variable = {
							var = PB_convert_progress
							min = 0
							max = 100
						} 
					}
				}

				else_if = {
					limit = {
						has_idea = PB_Significant_Autonomy
						any_state = {
							limit = {
								has_state_flag = PB_Culture_Convert_In_Progress
								is_owned_by = ROOT
							}
						}
					}
					every_state = {
						limit = {
							has_state_flag = PB_Culture_Convert_In_Progress
							is_owned_by = ROOT
						}
						add_to_variable = { PB_convert_progress = 3 }
						clamp_variable = {
							var = PB_convert_progress
							min = 0
							max = 100
						} 
					}
				}

				else_if = {
					limit = {
						has_idea = PB_Limited_Autonomy
						any_state = {
							limit = {
								OR = {
									has_state_flag = PB_Culture_Accept_In_Progress
									has_state_flag = PB_Culture_Convert_In_Progress
								}
								is_owned_by = ROOT
							}
						}
					}
					every_state = {
						limit = {
							OR = {
								has_state_flag = PB_Culture_Accept_In_Progress
								has_state_flag = PB_Culture_Convert_In_Progress
							}
							is_owned_by = ROOT
						}
						add_to_variable = { PB_convert_progress = 3 }
						clamp_variable = {
							var = PB_convert_progress
							min = 0
							max = 100
						} 
					}
				}

				else_if = {
					limit = {						
						has_idea = PB_Racial_Segregation
						any_state = {
							limit = {
								has_state_flag = PB_Culture_Convert_In_Progress
								is_owned_by = ROOT
							}
						}
					}
					every_state = {
						limit = {
							has_state_flag = PB_Culture_Convert_In_Progress
							is_owned_by = ROOT
						}
						add_to_variable = { PB_convert_progress = 6 }
						clamp_variable = {
							var = PB_convert_progress
							min = 0
							max = 100
						} 
					}
				}

				else_if = {
					limit = {
						has_idea = PB_Racial_Segregation
						any_state = {
							limit = {
								has_state_flag = PB_Culture_Accept_In_Progress
								is_owned_by = ROOT
							}
						}
					}
					every_state = {
						limit = {
							has_state_flag = PB_Culture_Accept_In_Progress
							is_owned_by = ROOT
						}
						add_to_variable = { PB_convert_progress = 3 }
						clamp_variable = {
							var = PB_convert_progress
							min = 0
							max = 100
						} 
					}
				}
				
				else_if = {
					limit = {
						has_idea = PB_Racial_Hierarchy
						any_state = {
							limit = {
								has_state_flag = PB_Culture_Convert_In_Progress
								is_owned_by = ROOT
							}
						}
					}
					every_state = {
						limit = {
							has_state_flag = PB_Culture_Convert_In_Progress
							is_owned_by = ROOT
						}
						add_to_variable = { PB_convert_progress = 9 }
						clamp_variable = {
							var = PB_convert_progress
							min = 0
							max = 100
						} 
					}
				}
			}
		} 
	}
}