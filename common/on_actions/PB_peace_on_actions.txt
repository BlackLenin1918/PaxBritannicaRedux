on_actions = {
	#### PEACE/WAR VICTORY ON_CAPITULATION BLOCK ####
	#### PUT YOUR SHIT HERE
	# At the end of each global block, set the skip_default_capitulation GLOBAL flag
	# go away stinky vanilla peace

	# FROM = winner 
	# ROOT = country being capitulated/loser

	# DO NOT FUCKING TOUCH THIS
	# I AM DEATHLY FUCKING SERIOUS RIGHT NOW
	# XOXO - Grestin
	# Somtimes I wonder if this system is even worth the pain - Bernie
	# Make sure to space stuff out properly and keep everything neat - Bernie

	on_capitulation = {
		effect = {
			log = "[GetDateText]: FROM: [From.GetName] ROOT: [Root.GetName] on_capitulation"

			set_global_flag = show_peace_popup_alert
			FROM = {
				save_global_event_target_as = winning_country
			} 
			ROOT = {
				save_global_event_target_as = losing_country
			}

			log = "[GetDateText]: winner/loser: FROM: [winning_country.GetName] ROOT: [losing_country.GetName] on_capitulation"

			if = {
				limit = {
					event_target:losing_country = {
						any_allied_country = {
							has_war_together_with = event_target:losing_country
						}
					}
				}
				set_global_flag = losing_country_multiple
			}

			if = {
				limit = {
					event_target:winning_country = {
						any_allied_country = {
							has_war_together_with = event_target:winning_country
						}
					}
				}
				set_global_flag = winning_country_multiple
			}

			#Annexation block
			# this will only trigger ROOT (the loser) is in a faction and is NOT the only survivor of said faction
			# if ROOT is the only survivor then it will trigger the proper effects below
			if = {
				limit = {
					NOT = {
						ROOT = {
							has_country_flag = PB_DO_NOT_DELETE_ME # Seriously don't 
						}
					}
				}
			    set_global_flag = war_won

			    # normal peace stuff

				if = { # Failsafe Event for the league beating Turkey
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = ENG
		        				is_in_faction_with = ENG
		        			}
					    }
					    ROOT = {
						    original_tag = TUR
					    }
				    }

				    ENG = {
					    white_peace = ROOT
				    }

					if = {
	                    limit = {
		                    OR = {
			                    has_dlc = "Together for Victory"
			                    has_dlc = "Man the Guns"
		                    }
				            TUR = {
					            is_subject_of = RUS
				            }
	                    }

			            RUS = {
				            set_autonomy = {
                                target = TUR
                                autonomy_state = autonomy_free
                                end_wars = yes
                                end_civil_wars = yes
                            }
			            }
			            else = {
				            RUS = {
					            end_puppet = TUR
				            }
			            }
		            }

					TUR = {
			            drop_cosmetic_tag = yes
			            set_politics = {
	                        ruling_party = ds
                            elections_allowed = no
                            last_election = "1935.12.17"
                        }
		            }

		            if = {
			            limit = {
				            TUR = {
					            is_in_faction_with = RUS
				            }
			            }
			            leave_faction = yes
		            }

		            ENG = { add_to_faction = TUR }

				    set_global_flag = skip_default_capitulation
			    }

				if = { # Russia beats the Turkish revolt
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = RUS
		        				is_in_faction_with = RUS
								original_tag = FRA
		        				is_in_faction_with = FRA
		        			}
					    }
					    ROOT = {
						    original_tag = TUR
					    }
				    }

				    FROM = {
					    white_peace = ROOT
				    }

					TUR = {
						leave_faction = yes
					}

					if = {
	                    limit = {
		                    OR = {
			                    has_dlc = "Together for Victory"
			                    has_dlc = "Man the Guns"
		                    }
	                    }

						RUS = {
							set_autonomy = {
	                            target = TUR
	                            autonomous_state = autonomy_client_state
	                            freedom_level = 0.50
                            }
						}
			            else = {
							RUS = {
								puppet = TUR
							}
			            }
		            }

					TUR = {
						set_politics = {
	                        ruling_party = rc
                            elections_allowed = no
                            last_election = "1935.12.17"
                        }
						kill_country_leader = yes
						create_country_leader = {
	                        name = "Fevzi Cakmak"
	                        desc = "POLITICS_MOHAMMED_ZAHIR_SHAH_DESC"
	                        picture = Portrait_Fevzi_Cakmak
	                        expire = "1965.1.1"
	                        ideology = RC_VARIANT_01
	                        traits = {
							}
                        }
						drop_cosmetic_tag = yes
						set_cosmetic_tag = TUR_RUS_PUPPET
					}

					FRA = { add_to_faction = TUR }

				    set_global_flag = skip_default_capitulation
			    }

				if = { # Germany invades Serbia
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = GER
		        				is_in_faction_with = GER
		        			}
		        		}
		        		ROOT = {
		        			original_tag = SER
		        		}
		        	}

					GER = {
					    white_peace = ROOT
				    }

					MNT = {
			            transfer_state = 105
			            inherit_technology = SER
		            }

					BOS = {
			            transfer_state = 103
			            transfer_state = 104
			            inherit_technology = SER
						set_politics = {
	                        ruling_party = rc
                            elections_allowed = no
                            last_election = "1935.12.17"
                            election_frequency = 48
                        }
					}

					CRO = {
			            transfer_state = 109
			            transfer_state = 794
			            inherit_technology = SER
						set_politics = {
	                        ruling_party = cn
                            elections_allowed = no
                            last_election = "1935.12.17"
                            election_frequency = 48
                        }
					}

		            SER = {
			            remove_state_core = 103
						remove_state_core = 104
						remove_state_core = 105
						remove_state_core = 163
						remove_state_core = 109
						remove_state_core = 794
						set_politics = {
	                        ruling_party = rc
                            elections_allowed = no
                            last_election = "1935.12.17"
                            election_frequency = 48
                        }
		            }		

					ALB = {
			            transfer_state = 163
		            }		

		        	set_global_flag = skip_default_capitulation
		        }

				if = { # Germany invades Serbia and looses
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = SER
		        				is_in_faction_with = SER
		        			}
					    }
					    ROOT = {
						    original_tag = GER
					    }
				    }

				    SER = {
					    white_peace = ROOT
				    }

				    set_global_flag = skip_default_capitulation
			    }

				if = { # Finland War
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = RUS
		        				is_in_faction_with = RUS
								original_tag = FIN
		        			}
					    }
					    ROOT = {
						    original_tag = FFI
					    }
				    }

				    RUS = {
					    white_peace = ROOT
				    }

					FIN = {
						white_peace = ROOT
						annex_country = {
						    target = ROOT
						    transfer_troops = no
					    }
					}

				    RUS = {
						annex_country = {
						    target = FIN
						    transfer_troops = yes
					    }
				    }

				    set_global_flag = skip_default_capitulation
			    }

				if = { # Finland War - Free Finland Victory
				    limit = {
					    FROM = {
							original_tag = FFI
					    }
					    ROOT = {
						    OR = {
		        				original_tag = RUS
		        				is_in_faction_with = RUS
								original_tag = FIN
		        			}
					    }
				    }

					FFI = {
						white_peace = FIN
						annex_country = {
						    target = FIN
						    transfer_troops = yes
					    }
					}

					RUS = {
						declare_war_on = {
							target = FFI
							type = annex_everything
						}						
					}

				    set_global_flag = skip_default_capitulation
			    }

				if = { # UK invasion of Yemen
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = ENG
		        				is_in_faction_with = ENG
		        			}
					    }
					    ROOT = {
						    original_tag = YEM
					    }
				    }

				    ENG = {
					    white_peace = ROOT
						annex_country = {
						    target = ROOT
						    transfer_troops = no
					    }
				    }

				    set_global_flag = skip_default_capitulation
			    }

				if = { # GER invades GOS (looses)
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = GOS
		        				is_in_faction_with = GOS
		        			}
					    }
					    ROOT = {
						    original_tag = GER
					    }
				    }

				    GOS = {
					    white_peace = ROOT
				    }

					GER = {
						remove_wargoal = {
                            type = all
                            target = GOS
                        }
					}

				    set_global_flag = skip_default_capitulation
			    }

				if = { # German invasion of GOS
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = GER
		        				has_war_together_with = GER
		        			}
					    }
					    ROOT = {
						    original_tag = GOS
					    }
				    }

				    GER = {
					    white_peace = ROOT
				    }

					HOL = {
					    white_peace = ROOT
						annex_country = {
						    target = ROOT
						    transfer_troops = no
					    }
				    }

				    set_global_flag = skip_default_capitulation
			    }

				if = { # German invasion of SWA
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = GER
		        				has_war_together_with = GER
		        			}
					    }
					    ROOT = {
						    original_tag = SWA
					    }
				    }

				    GER = {
					    white_peace = ROOT
				    }

					HOL = {
					    white_peace = ROOT
						annex_country = {
						    target = ROOT
						    transfer_troops = no
					    }
				    }

				    set_global_flag = skip_default_capitulation
			    }

				if = { # GER invades SWA (looses)
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = SWA
		        				is_in_faction_with = SWA
		        			}
					    }
					    ROOT = {
						    original_tag = GER
					    }
				    }

				    SWA = {
					    white_peace = ROOT
				    }

					GER = {
						remove_wargoal = {
                            type = all
                            target = SWA
                        }
					}

				    set_global_flag = skip_default_capitulation
			    }

				if = { # German invasion of NAT
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = GER
		        				has_war_together_with = GER
		        			}
					    }
					    ROOT = {
						    original_tag = NAT
					    }
				    }

				    GER = {
					    white_peace = ROOT
				    }

					HOL = {
					    white_peace = ROOT
						annex_country = {
						    target = ROOT
						    transfer_troops = no
					    }
				    }

				    set_global_flag = skip_default_capitulation
			    }

				if = { # GER invades NAT (looses)
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = NAT
		        				is_in_faction_with = NAT
		        			}
					    }
					    ROOT = {
						    original_tag = GER
					    }
				    }

				    NAT = {
					    white_peace = ROOT
				    }

					GER = {
						remove_wargoal = {
                            type = all
                            target = NAT
                        }
					}

				    set_global_flag = skip_default_capitulation
			    }

				if = { # German invasion of ORJ
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = GER
		        				has_war_together_with = GER
		        			}
					    }
					    ROOT = {
						    original_tag = ORJ
					    }
				    }

				    GER = {
					    white_peace = ROOT
				    }

					HOL = {
					    white_peace = ROOT
						annex_country = {
						    target = ROOT
						    transfer_troops = no
					    }
				    }

				    set_global_flag = skip_default_capitulation
			    }

				if = { # GER invades ORJ (looses)
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = ORJ
		        				is_in_faction_with = ORJ
		        			}
					    }
					    ROOT = {
						    original_tag = GER
					    }
				    }

				    ORJ = {
					    white_peace = ROOT
				    }

					GER = {
						remove_wargoal = {
                            type = all
                            target = ORJ
                        }
					}

				    set_global_flag = skip_default_capitulation
			    }

				if = { # German invasion of NRP
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = GER
		        				has_war_together_with = GER
		        			}
					    }
					    ROOT = {
						    original_tag = NRP
					    }
				    }

				    GER = {
					    white_peace = ROOT
				    }

					HOL = {
					    white_peace = ROOT
						annex_country = {
						    target = ROOT
						    transfer_troops = no
					    }
				    }

				    set_global_flag = skip_default_capitulation
			    }

				if = { # GER invades NRP (looses)
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = NRP
		        				is_in_faction_with = NRP
		        			}
					    }
					    ROOT = {
						    original_tag = GER
					    }
				    }

				    NRP = {
					    white_peace = ROOT
				    }

					GER = {
						remove_wargoal = {
                            type = all
                            target = NRP
                        }
					}

				    set_global_flag = skip_default_capitulation
			    }


				if = { # German invasion of Kingdom of Portugal - Portugal defeated
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = GER
		        				is_in_faction_with = GER
		        			}
					    }
					    ROOT = {
						    original_tag = PEF
					    }
				    }

					PEF = {
						remove_ideas = PB_GER_Central_African_Bush_War
					}

				    GER = {
					    white_peace = ROOT
						annex_country = {
						    target = ROOT
						    transfer_troops = no
					    }
						remove_ideas = PB_GER_Central_African_Bush_War
				    }

				    set_global_flag = skip_default_capitulation
			    }

				if = { # German invasion of Kingdom of Portugal - Germany defeated
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = PEF
		        				is_in_faction_with = PEF
		        			}
					    }
					    ROOT = {
						    original_tag = GER
					    }
				    }

				    PEF = {
					    white_peace = ROOT
						transfer_state = 546
						transfer_state = 869
						transfer_state = 871
						transfer_state = 870
						transfer_state = 769
						transfer_state = 768
						remove_ideas = PB_GER_Central_African_Bush_War
				    }

					GER = {
						remove_ideas = PB_GER_Central_African_Bush_War
					}


				    set_global_flag = skip_default_capitulation
			    }

				if = { # German invasion of Hungary - Victory
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = GER
		        				is_in_faction_with = GER
		        			}
					    }
					    ROOT = {
						    original_tag = HUN
					    }
				    }

				    GER = {
					    white_peace = ROOT
						diplomatic_relation = {
                            country = HUN
                            relation = non_aggression_pact
                            active = yes
                        }
						news_event = {
                            id = PBNews.160
                            days = 1
                        }
				    }

					ROOT = {
						set_political_party = {
                            ideology = cn
                            popularity = 35
                        }
						set_politics = {
	                        ruling_party = cn
                            elections_allowed = no
                            last_election = "1935.12.17"
                            election_frequency = 48
                        }
						
						set_cosmetic_tag = HUN_Transleithania
					}

					if = {
						limit = {
							AND = {
								HUN = {
									owns_state = 109
									owns_state = 794
								}
								CRO = {
									exists = no
								}
							}
						}
						CRO = {
							transfer_state = 109
							transfer_state = 794
							set_political_party = {
                                ideology = cn
                                popularity = 55
                            }
						    set_politics = {
	                            ruling_party = cn
                                elections_allowed = no
                                last_election = "1935.12.17"
                                election_frequency = 48
                            }
						}
					}

					if = {
						limit = {
							CRO = {
								is_subject_of = HUN
							}
						}
						HUN = {
							end_puppet = CRO
						}
						CRO = {
							set_political_party = {
                                ideology = cn
                                popularity = 55
                            }
						    set_politics = {
	                            ruling_party = cn
                                elections_allowed = no
                                last_election = "1935.12.17"
                                election_frequency = 48
                            }
						}
					}
					
				    set_global_flag = skip_default_capitulation
			    }	

				if = { # German invasion of Hungary - Croatia defeated
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = GER
		        				is_in_faction_with = GER
		        			}
					    }
					    ROOT = {
						    original_tag = CRO
					    }
				    }

					if = {
						limit = {
							CRO = {
								is_subject_of = HUN
							}
						}
						HUN = {
							end_puppet = CRO
						}
						CRO = {
							set_political_party = {
                                ideology = cn
                                popularity = 55
                            }
						    set_politics = {
	                            ruling_party = cn
                                elections_allowed = no
                                last_election = "1935.12.17"
                                election_frequency = 48
                            }
						}
					}

				    GER = {
					    white_peace = ROOT
				    }

				    set_global_flag = skip_default_capitulation
			    }	

				if = { # German invasion of Hungary - Defeat
				    limit = {
					    FROM = {
						    OR = {
		        				original_tag = HUN
		        				is_in_faction_with = HUN
		        			}
					    }
					    ROOT = {
						    original_tag = GER
					    }
				    }

				    HUN = {
					    white_peace = ROOT
				    }

				    set_global_flag = skip_default_capitulation
			    }	


			    if = { # Malaysian insurguncy - Defeat
				    limit = {
					    FROM = {
						    has_country_flag = PB_WAR_SYSTEM_Malaysian_Insurgency
						    original_tag = KAL
					    }
					    ROOT = {
						    has_country_flag = PB_WAR_SYSTEM_Malaysian_Insurgency
						    original_tag = MAL
					    }
				    }

				    FROM = {
					    country_event = {
						    id = waroutcome.1
						    days = 7
					    }
					    white_peace = ROOT
					    annex_country = {
						    target = ROOT
						    transfer_troops = no
					    }
				    }
				    set_global_flag = skip_default_capitulation
			    }	
				

			    if = { # Malaysian insurguncy - Victory
				    limit = {
					    FROM = {
						    has_country_flag = PB_WAR_SYSTEM_Malaysian_Insurgency
						    original_tag = MAL
					    }
					    ROOT = {
						    has_country_flag = PB_WAR_SYSTEM_Malaysian_Insurgency
						    original_tag = KAL
					    }
				    }

				    FROM = {
					    country_event = {
						    id = waroutcome.2
						    days = 7
					    }

					    white_peace = ROOT

					    drop_cosmetic_tag = yes
				    }
				    set_global_flag = skip_default_capitulation
			    }	

			    if = { # Filipino Insurgency - German Victory
				    limit = {
					    FROM = {
							OR = {
								original_tag = DAS
								original_tag = GER
							}
					    }
					    ROOT = {
						    original_tag = PHI
					    }
				    }

				    FROM = {
					    white_peace = ROOT

					    annex_country = {
					        target = ROOT
						    transfer_troops = no
					    }
				    }
				    set_global_flag = skip_default_capitulation
			    }
		
			    if = { # Irish Secession Crisis - Loyalist Victory
				    limit = {
					    FROM = {
						    OR = {
							    original_tag = IRE
							    original_tag = ENG
								is_in_faction_with = ENG
						    }
					    }
					    ROOT = {
						    original_tag = ICA
					    }
						NOT = {
							has_global_flag = PB_Ulster_Crisis_War
						}
				    }

				    IRE = {
					    white_peace = ROOT
					    annex_country = {
					        target = ROOT
						    transfer_troops = no
					    }
				    }
					ENG = {
						country_event = {
							id = britain.63
							days = 1
						}
					}
				    set_global_flag = skip_default_capitulation
			    }	

			    if = { # Ulster Crisis War - Loyalist Victory
				    limit = {
					    FROM = {
						    OR = {
							    original_tag = ENG
							    original_tag = ULS
								is_in_faction_with = ENG
						    }
					    }
					    ROOT = {
						    original_tag = ICA
					    }
						has_global_flag = PB_Ulster_Crisis_War
				    }

				    ENG = {
					    white_peace = ROOT
					    annex_country = {
					        target = ROOT
						    transfer_troops = no
					    }
				    }
					ENG = {
					    annex_country = {
					        target = ULS
						    transfer_troops = no
					    }
					}
					clr_global_flag = PB_Ulster_Crisis_War

				    set_global_flag = skip_default_capitulation
			    }

			    if = { # Ulster Crisis War - Irish Victory
				    limit = {
					    FROM = {
							original_tag = ICA
					    }
					    ROOT = {
						    OR = {
							    original_tag = ENG
							    original_tag = ULS
							}
					    }
						has_global_flag = PB_Ulster_Crisis_War
				    }

				    ICA = {
					    white_peace = ROOT
					    annex_country = {
					        target = ULS
						    transfer_troops = no
					    }
				    }
					clr_global_flag = PB_Ulster_Crisis_War

				    set_global_flag = skip_default_capitulation
			    }

			    if = { # Chinese Civil War - Qing Victory
				    limit = {
					    FROM = {
							OR = {
								is_in_faction_with = CHI
								original_tag = CHI
							}
					    }
					    ROOT = {
						    original_tag = ROC
					    }
				    }

				    CHI = {
					    white_peace = ROOT
					    annex_country = {
						    target = ROOT
						    transfer_troops = no
					    }
				    }

					CHI = {
						news_event = { 
						    id = PBNews.184 
						    days = 1 
					    } 
						country_event = { 
						    id = qing.48
						    days = 5
					    } 
					}
				    set_global_flag = skip_default_capitulation
			    }

			    if = { # Chinese Civil War - Republican Victory
				    limit = {
					    FROM = {
						    OR = {
								is_in_faction_with = ROC
								original_tag = ROC
							}
					    }
					    ROOT = {
					        original_tag = CHI
					    }
				    }

				    ROC = {
					    white_peace = ROOT
					    annex_country = {
						    target = ROOT
						    transfer_troops = no
				        }
				    }   

					ROC = {
						set_cosmetic_tag = CHI_United_States
						set_capital = {state = 608}
						news_event = { 
						    id = PBNews.183 
						    days = 1 
					    } 
						country_event = { 
						    id = qing.48
						    days = 5
					    } 
					}
				    set_global_flag = skip_default_capitulation
			    }

				if = { # China reclaims TIB
				    limit = {
					    FROM = {
							OR = {
								is_in_faction_with = CHI
								original_tag = CHI
								is_in_faction_with = ROC
								original_tag = ROC
							}
					    }
					    ROOT = {
						    original_tag = TIB
					    }
				    }

				    if = {
						limit = {
							ROC = {
								exists = yes
							}
						}
						ROC = {
					        white_peace = ROOT
					            annex_country = {
						        target = ROOT
						        transfer_troops = no
				            }
				        }  
						else_if = {
							limit = {
								CHI = {
								    exists = yes
							    }
							}
							CHI = {
					            white_peace = ROOT
					                annex_country = {
						            target = ROOT
						            transfer_troops = no
				                }
				            }
						} 
					}
				    set_global_flag = skip_default_capitulation
			    }

				if = { # China reclaims ETR
				    limit = {
					    FROM = {
							OR = {
								is_in_faction_with = CHI
								original_tag = CHI
								is_in_faction_with = ROC
								original_tag = ROC
							}
					    }
					    ROOT = {
						    original_tag = ETR
					    }
				    }

				    if = {
						limit = {
							ROC = {
								exists = yes
							}
						}
						ROC = {
					        white_peace = ROOT
					        annex_country = {
						        target = ROOT
						        transfer_troops = no
				            }
				        }  
						else_if = {
							limit = {
								CHI = {
								    exists = yes
							    }
							}
							CHI = {
					            white_peace = ROOT
					            annex_country = {
						            target = ROOT
						            transfer_troops = no
				                }
				            }
						} 
					}
				    set_global_flag = skip_default_capitulation
			    }

				if = { # China reclaims KUM
				    limit = {
					    FROM = {
							OR = {
								is_in_faction_with = CHI
								original_tag = CHI
								is_in_faction_with = ROC
								original_tag = ROC
							}
					    }
					    ROOT = {
						    original_tag = KUM
					    }
				    }

				    if = {
						limit = {
							ROC = {
								exists = yes
							}
						}
						ROC = {
					        white_peace = ROOT
					        annex_country = {
						        target = ROOT
						        transfer_troops = no
				            }
				        }  
						else_if = {
							limit = {
								CHI = {
								    exists = yes
							    }
							}
							CHI = {
					            white_peace = ROOT
					            annex_country = {
						            target = ROOT
						            transfer_troops = no
				                }
				            }
						} 
					}
				    set_global_flag = skip_default_capitulation
			    }

				if = { # China reclaims XSM OR FTR #Uses both tags incase either side is still at war with each other
				    limit = {
					    FROM = {
							OR = {
								is_in_faction_with = CHI
								original_tag = CHI
								is_in_faction_with = ROC
								original_tag = ROC
							}
					    }
					    ROOT = {
							OR = {
								original_tag = XSM
                                original_tag = FTR
							}
					    }
				    }

				    if = {
						limit = {
							ROC = {
								exists = yes
							}
						}
						ROC = {
					        white_peace = XSM
							white_peace = FTR
					        annex_country = {
						        target = XSM
						        transfer_troops = no
				            }
							annex_country = {
						        target = FTR
						        transfer_troops = no
				            }
				        }  
						else_if = {
							limit = {
								CHI = {
								    exists = yes
							    }
							}
							CHI = {
					            white_peace = XSM
							    white_peace = FTR
					            annex_country = {
						            target = XSM
						            transfer_troops = no
				                }
							    annex_country = {
						            target = FTR
						            transfer_troops = no
				                }
				            }
						} 
					}
				    set_global_flag = skip_default_capitulation
			    }

				if = { # China reclaims SGH
				    limit = {
					    FROM = {
							OR = {
								is_in_faction_with = CHI
								original_tag = CHI
								is_in_faction_with = ROC
								original_tag = ROC
							}
					    }
					    ROOT = {
						    original_tag = SGH
					    }
				    }

				    if = {
						limit = {
							ROC = {
								exists = yes
							}
						}
						ROC = {
					        white_peace = ROOT
					        annex_country = {
						        target = ROOT
						        transfer_troops = no
				            }
				        }  
						else_if = {
							limit = {
								CHI = {
								    exists = yes
							    }
							}
							CHI = {
					            white_peace = ROOT
					            annex_country = {
						            target = ROOT
						            transfer_troops = no
				                }
				            }
						} 
					}
				    set_global_flag = skip_default_capitulation
			    }

			    if = { # Polish Revolt - Defeat
				    limit = {
					    FROM = {
						    OR = {
								is_in_faction_with = RUS
								original_tag = RUS
							}
					    }
					    ROOT = {
						    original_tag = POL
					    }
				    }

				    RUS = {
					    white_peace = ROOT
					    annex_country = {
						    target = ROOT
						    transfer_troops = no
					    }
			            news_event = { 
						    id = PBNews.128 
						    days = 1 
					    } 
					    add_state_core = 97
					    add_state_core = 91
					    add_state_core = 89
					    add_state_core = 92
					    add_state_core = 98
					    add_state_core = 10
					    add_state_core = 90
					    add_state_core = 87
					    add_state_core = 67
					    add_state_core = 762
					    add_state_core = 88
				    } 
				    set_global_flag = skip_default_capitulation
			   }

			    if = { # Chinese Civil War - Russian Invasion of Mongolia
				    limit = {
					    FROM = {
						    OR = {
								is_in_faction_with = RUS
								original_tag = RUS
							}
					    }
					    ROOT = {
						    original_tag = MON
					    }
				    }

				    RUS = {
					    white_peace = ROOT
					    set_autonomy = {
						    target = MON
						    autonomous_state = autonomy_PB_Imperial_Autonomy
						    freedom_level = 0.5
					    }	
				    }

				    MON = {
					    transfer_state = 321
					    transfer_state = 297
					    transfer_state = 330	
					    set_politics = { 
						    ruling_party = ds
						    elections_allowed = no 
					    }
					    add_popularity = {
						    ideology = ds
						    popularity = 0.05
					    }
 
					    create_country_leader = {
						    name = "Demchugdongrub"
						    desc = "POLITICS_MOHAMMED_ZAHIR_SHAH_DESC"
						    picture = "Portrait_MON_Demchugdongrub.dds"
						    ideology = DS_VARIANT_06
					    }

					    set_cosmetic_tag = MON_RUS_Nationalists
				    }
				    set_global_flag = skip_default_capitulation
			    }

			    if = { # Chinese Civil War - Russian Invasion of Manchuria
				    limit = {
					    FROM = {
						    OR = {
							    is_in_faction_with = RUS
							    original_tag = RUS
						    }
					    }
					    ROOT = {
						    original_tag = MAN
					    }	    
					}

				    RUS = {
					    white_peace = ROOT
					    set_autonomy = {
						    target = MAN
						    autonomous_state = autonomy_PB_Imperial_Autonomy
						    freedom_level = 0.5
					    }
				    }

				    MAN = {
					    transfer_state = 610
				        transfer_state = 716
					    transfer_state = 328
					    transfer_state = 715
					    transfer_state = 714
					    transfer_state = 717
					    transfer_state = 761

					    set_politics = { 
						    ruling_party = ds
						    elections_allowed = no 
					    }

					    add_popularity = {
						    ideology = ds
						    popularity = 0.05
					    }

					    create_country_leader = {
						    name = "Zhang Jinghui"
						    desc = "POLITICS_MOHAMMED_ZAHIR_SHAH_DESC"
						    picture = "Portrait_MAN_Zhang_Jinghui.dds"
						    ideology = DS_VARIANT_01
					    }

					    set_cosmetic_tag = MAN_RUS_Puppet
				    }
				    set_global_flag = skip_default_capitulation
			    }

			    if = { # Chinese Civil War - Central Plains War - Xebei Victory
				    limit = {
					    FROM = {
						    original_tag = XSM
					    }
					    ROOT = {
						    original_tag = FTR
					    }
				    }

				    FROM = {
					    white_peace = ROOT
					    annex_country = {
						    target = ROOT
						    transfer_troops = no
					    }
				    }
				    set_global_flag = skip_default_capitulation
			    }

			    if = { # Chinese Civil War - Central Plains War - Free Territory Victory
			    	limit = {
			    		FROM = {
			    			original_tag = FTR
			    		}
			    		ROOT = {
			    			original_tag = XSM
			    		}
			    	}

    			    	FROM = {
			    		white_peace = ROOT
			    		annex_country = {
			    			target = ROOT
			    			transfer_troops = no
			    		}
			    	}
			    	set_global_flag = skip_default_capitulation
			    }

			    if = { # Arab Wars
			    	limit = {
			    		FROM = {
			    			OR = {
			    				original_tag = HEJ
			    				original_tag = JBS
			    				original_tag = JOR
			    				original_tag = SYR
			    				original_tag = MIQ
			    				original_tag = YEM
			    				original_tag = IKW
			    				original_tag = UAR
			    			}
			    		}
			    		ROOT = {
			    			OR = {
			    				original_tag = HEJ
			    				original_tag = JBS
			    				original_tag = JOR
			    				original_tag = SYR
			    				original_tag = MIQ
			    				original_tag = YEM
			    				original_tag = IKW
			    				original_tag = UAR
			    			}
			    		}
			    	}
    
			    	FROM = {
			    		white_peace = ROOT
			    		annex_country = {
			    			target = ROOT
			    			transfer_troops = no
			    		}
			    	}
			    	set_global_flag = skip_default_capitulation
			    }
    
			    if = { # British Africa Algeria Invasion
			    	limit = {
			    		FROM = {
			    			original_tag = BAF
			    		}
			    		ROOT = {
			    			OR = {
			    				original_tag = ALG
			    				original_tag = FRG
			    			}
			    		}
			    	}
    
			    	FROM = {
			    		white_peace = ROOT
			    		annex_country = {
			    			target = ROOT
			    			transfer_troops = no
			    		}
			    	}

					BAF = {
						remove_idea = ENG_Algiers_Expedition
					}
			    	set_global_flag = skip_default_capitulation
			    }
    
			    if = { # South African War - Natalia Victory against Swazi
			    	limit = {
			    		FROM = {
			    			OR = {
			    				original_tag = NAT
			    				original_tag = GOS
			    			}
			    		}
			    		ROOT = {
			    			original_tag = SWA
			    		}
			    	}
			    	FROM = {
			    		white_peace = ROOT
			    	}
			    	NAT = {
			    		annex_country = {
			    			target = SWA
			    			transfer_troops = no
			    		}
			    	}
    
			    	set_global_flag = skip_default_capitulation
			    }
    
			    if = { # German Liberation Front - Got beamed out of existance
			    	limit = {
			    		FROM = {
			    			OR = {
			    				original_tag = FRA
			    				is_in_faction_with = FRA
			    			}
			    		}
			    		ROOT = {
			    			original_tag = GLF
			    		}
			    	}
			    	FROM = {
			    		white_peace = ROOT
			    	}
			    	MGE = {
			    		annex_country = {
			    			target = GLF
			    			transfer_troops = no
			    		}
			    	}
					GLF = {
						remove_state_core = 56
						remove_state_core = 59
						remove_state_core = 917
						remove_state_core = 57
						remove_state_core = 55
						remove_state_core = 54
						remove_state_core = 51
						remove_state_core = 60
					}
    
			    	set_global_flag = skip_default_capitulation
			    }
    
			    if = { # France Beats Brittany
			    	limit = {
			    		FROM = {
			    			OR = {
			    				original_tag = FRA
			    				is_in_faction_with = FRA
			    			}
			    		}
			    		ROOT = {
			    			original_tag = BRT
			    		}
			    	}
			    	FROM = {
			    		white_peace = ROOT
			    	}
			    	FRA = {
			    		annex_country = {
			    			target = BRT
			    			transfer_troops = no
			    		}
			    		news_event = {
			    			id = PBNews.84
			    			days = 1
			    	    }
			    	}
    
			    	set_global_flag = skip_default_capitulation
			    }
    
			    if = { # France Beats Wallonia
			    	limit = {
			    		FROM = {
			    			OR = {
			    				original_tag = FRA
			    				is_in_faction_with = FRA
			    			}
			    		}
			    		ROOT = {
			    			original_tag = WLA
			    		}
			    	}
			    	FROM = {
			    		white_peace = ROOT
			    	}
			    	FRA = {
			    		annex_country = {
			    			target = WLA
			    			transfer_troops = no
			    		}
			    		news_event = {
			    			id = PBNews.100
			    			days = 1
			    	    }
			    	}
    
			    	set_global_flag = skip_default_capitulation
			    }
    
			    if = { # France Beats Holland
			    	limit = {
			    		FROM = {
			    			OR = {
			    				original_tag = FRA
			    				is_in_faction_with = FRA
			    			}
			    		}
			    		ROOT = {
			    			original_tag = HOL
			    		}
			    	}
			    	FRA = {
			    		white_peace = HOL
						white_peace = GOS
						white_peace = SWA
						white_peace = ORJ
						white_peace = NAT
						white_peace = NRP
						white_peace = INS
						white_peace = NBT
			    	}
			    	FRA = {
			    		annex_country = {
			    			target = HOL
			    			transfer_troops = no
			    		}
			    		news_event = {
			    			id = PBNews.101
			    			days = 1
			    	    }
			    	}
			    	HOL = {
			    		transfer_state = 856
			    		transfer_state = 857
			    		transfer_state = 310
			    		transfer_state = 309
						transfer_state = 422
						transfer_state = 848
			    		set_cosmetic_tag = HOL_Exiled
			    		set_country_flag = HOL_Dutch_Exiled
			    
			    		add_opinion_modifier = {
			    			target = FRA modifier = aggressive_expansionism
			    		}
			    	}
    
			    	set_global_flag = skip_default_capitulation
			    }
    
			    if = { # France Beats Corsica
			    	limit = {
			    		FROM = {
			    			OR = {
			    				original_tag = FRA
			    				is_in_faction_with = FRA
			    			}
			    		}
			    		ROOT = {
			    			original_tag = COR
			    		}
			    	}
			    	FROM = {
			    		white_peace = ROOT
			    	}
			    	FRA = {
			    		annex_country = {
			    			target = COR
			    			transfer_troops = no
			    		}
			    		news_event = {
			    			id = PBNews.102
			    			days = 1
			    	    }
			    	}
    
			    	set_global_flag = skip_default_capitulation
			    }
    
			    if = { # France Beats Basque
			    	limit = {
			    		FROM = {
			    			OR = {
			    				original_tag = FRA
			    				is_in_faction_with = FRA
			    			}
			    		}
			    		ROOT = {
			    			original_tag = BSQ
			    		}
			    	}
			    	FROM = {
			    		white_peace = ROOT
			    	}
			    	FRA = {
			    		annex_country = {
			    			target = BSQ
			    			transfer_troops = no
			    		}
			    		news_event = {
			    			id = PBNews.103
			    			days = 1
			    	    }
			    	}
    
			    	set_global_flag = skip_default_capitulation
			    }
    
		        if = { #Great Balkan War - Entente Victory against Serbia
			        limit = {
			    	    FROM = {
			    		    OR = {
			    			    original_tag = HUN
			    			    is_in_faction_with = HUN
			    		    }
			    	    }
			    	    ROOT = {
			    		    original_tag = SER
			    	    }
			    	    has_global_flag = Great_Balkan_War_Fired
			        }
			        SER = {
			    	    leave_faction = yes
			    	    white_peace = HUN
			    	    white_peace = BUL
			    	    white_peace = CRO
			        }
			        HUN = {
			    	    country_event = {
			    		    id = balkwar.10
			    	    }
			        }
			        set_global_flag = PB_GBW_Serbia_Defeated
    
			        set_global_flag = skip_default_capitulation
		        }
    
		        if = { #Great Balkan War - Entente Victory against Romania
			        limit = {
			    	    FROM = {
			    		    OR = {
			    			    original_tag = HUN
			    			    is_in_faction_with = HUN
			    		    }
			    	    }
			    	    ROOT = {
			    		    original_tag = ROM
			    	    }
			    	    has_global_flag = Great_Balkan_War_Fired
			        }
			        ROM = {
			    	    leave_faction = yes
			    	    white_peace = HUN
			    	    white_peace = BUL
			    	    white_peace = CRO
			        }
			        HUN = {
			    	    country_event = {
			    		    id = balkwar.21
			    	    }
			        }
			        set_global_flag = PB_GBW_Romania_Defeated
    
			        set_global_flag = skip_default_capitulation
		        }

		        if = { #Great Balkan War - Serbian Victory against Hungary
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = SER
		        				is_in_faction_with = SER
		        			}
		        		}
		        		ROOT = {
		        			original_tag = HUN
		        		}
		        		has_global_flag = Great_Balkan_War_Fired
		        	}
		        	HUN = {
		        		leave_faction = yes
		        		white_peace = SER
		        		white_peace = ROM
		        	}
		        	HUN = {
		        		country_event = { 
		        			id = balkwar.23
		        		}
		        	}
		        	set_global_flag = PB_GBW_Hungary_Defeated
        
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { #Great Balkan War - Serbian Victory against Croatia
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = SER
		        				is_in_faction_with = SER
		        			}
		        		}
		        		ROOT = {
		        			original_tag = CRO
		        		}
		        		has_global_flag = Great_Balkan_War_Fired
		        	}
		        	HUN = {
		        		end_puppet = CRO
		        	}
		        	CRO = {
		        		leave_faction = yes
		        		white_peace = SER
		        		white_peace = ROM
		        	}
		        	SER = {
		        		country_event = {
		        			id = balkwar.22
		        		}
		        	}
		        	set_global_flag = PB_GBW_Croatia_Defeated
        
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { #Great Balkan War - Serbian Victory against Bulgaria
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = SER
		        				is_in_faction_with = SER
		        			}
		        		}
		        		ROOT = {
		        			original_tag = BUL
		        		}
		        		has_global_flag = Great_Balkan_War_Fired
		        	}
		        	BUL = {
		        		leave_faction = yes
		        		white_peace = SER
		        		white_peace = ROM
		        	}
		        	SER = {
		        		country_event = {
		        			id = balkwar.24
		        		}
		        	}
		        	set_global_flag = PB_GBW_Bulgaria_Defeated
        
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { #South African War - Natalia Victory
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = NAT
		        				is_in_faction_with = NAT
		        			}
		        		}
		        		ROOT = {
		        			original_tag = NRP
		        		}
		        	}
        
		        	NAT = {
		        		white_peace = NRP
		        		white_peace = ORJ
		        		annex_country = {
		        			target = NRP
		        			transfer_troops = no
		        		}
		        		annex_country = {
		        			target = ORJ
		        			transfer_troops = no
		        		}
		        		country_event = { id = south_africa.16 } 
		        	}
        
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { #South African War - New Republic Victory
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = NRP
		        				is_in_faction_with = NRP
		        			}
		        		}
		        		ROOT = {
		        			original_tag = NAT
		        		}
		        	}
        
		        	FROM = {
		        		white_peace = ROOT
		        	}
        
		        	NRP = {
		        		country_event = { id = south_africa.17 } 
		        		annex_country = {
		        			target = NAT
		        			transfer_troops = no
		        		}
		        		annex_country = {
		        			target = GOS
		        			transfer_troops = no
		        		}
		        	}
		        	set_global_flag = skip_default_capitulation
		        }	
        
		        if = { #South African War - Sudwestafrika Victory - Natalia
		        	limit = {
		        		FROM = {
		        			original_tag = SDW
		        		}
		        		ROOT = {
		        			AND = {
		        				original_tag = NAT
		        				original_tag = GOS
		        			}
		        		}
		        	}
        
		        	SDW = {
		        		set_country_flag = SDW_Has_Beaten_South_African_Fascists
		        		white_peace = NAT
		        		white_peace = ORJ
		        		annex_country = {
		        			target = NAT
		        			transfer_troops = no
		        		}
		        		annex_country = {
		        			target = GOS
		        			transfer_troops = no
		        		}
		        		if = {
		        			limit = {
		        				AND = {
		        					has_country_flag = SDW_Has_Beaten_South_African_Democrats
		        					has_country_flag = SDW_Has_Beaten_South_African_Fascists
		        				}
		        			}
		        			country_event = { id = south_africa.14 days = 3 } 
		        		}
		        	}
        
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { #South African War - Sudwestafrika Victory - New Republic
		        	limit = {
		        		FROM = {
		        			original_tag = SDW
		        		}
		        		ROOT = {
		        			AND = {
		        				original_tag = NRP
		        				original_tag = ORJ
		        			}
		        		}
		        	}
        
		        	SDW = {
		        		set_country_flag = SDW_Has_Beaten_South_African_Democrats
		        		white_peace = NRP
		        		white_peace = ORJ
		        		annex_country = {
		        			target = NRP
		        			transfer_troops = no
		        		}
		        		annex_country = {
		        			target = ORJ
		        			transfer_troops = no
		        		}
		        		if = {
		        			limit = {
		        				AND = {
		        					has_country_flag = SDW_Has_Beaten_South_African_Democrats
		        					has_country_flag = SDW_Has_Beaten_South_African_Fascists
		        				}
		        			}
		        			country_event = { id = south_africa.14 days = 3 } 
		        		}
		        	}
        
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { #Second Great War - League Victory in France
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = ENG
		        				is_in_faction_with = ENG
		        			}
		        		}
						ROOT = {
							original_tag = FRA
						}
		        	}
					FRA = {
						leave_faction = yes
					}
		        	every_country = {
		        		limit = {
		        			has_war_with = FRA
		        		}
		        		white_peace = FRA
		        	}
					OFA = {
						annex_country = {
							target = FRA
							transfer_troops = no
						}	
						add_state_core = 14
						add_state_core = 30
						add_state_core = 23
						add_state_core = 825
						add_state_core = 19
						add_state_core = 557
						add_state_core = 31
						add_state_core = 22
						add_state_core = 21
						add_state_core = 735
						add_state_core = 1
						add_state_core = 32
						add_state_core = 20
						add_state_core = 841
						add_state_core = 25
						add_state_core = 26
						add_state_core = 20
						add_state_core = 24
						add_state_core = 27
						add_state_core = 809
						add_state_core = 26
						add_state_core = 17
						add_state_core = 685
						add_state_core = 18
						add_state_core = 16
						add_state_core = 785
						add_state_core = 29
						add_state_core = 15
						if = {
							limit = {
								OFA = {
									owns_state = 36
								}
							}
							HOL = {
								transfer_state = 36
							}
						}
						if = {
							limit = {
								OFA = {
									owns_state = 7
								}
							}
							HOL = {
								transfer_state = 7
							}
						}
						if = {
							limit = {
								OFA = {
									owns_state = 911
								}
							}
							HOL = {
								transfer_state = 911
							}
						}
						if = {
							limit = {
								OFA = {
									owns_state = 35
								}
							}
							HOL = {
								transfer_state = 35
							}
						}
						if = {
							limit = {
								OFA = {
									owns_state = 910
								}
							}
							HOL = {
								transfer_state = 910
							}
						}
						if = {
							limit = {
								OFA = {
									owns_state = 6
								}
							}
							HOL = {
								transfer_state = 6
							}
						}
					}
					HOL = {
						drop_cosmetic_tag = yes
					}
					if = {
						limit = {
							HOL = {
								is_subject_of = GER
							}
							OR = {
			                    has_dlc = "Together for Victory"
			                    has_dlc = "Man the Guns"
		                    }
						}
						GER = {
							set_autonomy = {
                                target = HOL
                                autonomy_state = autonomy_free
                                end_wars = yes
                                end_civil_wars = yes
                            }
						}
						else = {
		                    end_puppet = HOL
	                    }
					}
					if = {
						limit = {
							PRS = {
								is_subject_of = FRA
							}
						}
						GER = {
							annex_country = {
							    target = PRS
							    transfer_troops = no
						    }	
						}
					}
		        	ENG = {
						country_event = { id = waroutcome.12 } 

		        		country_event = { id = waroutcome.5 days = 5 } 

						set_country_flag = FRA_ENG_WW2_VICTOR
		        	}
					if = {
						limit = {
							GER = {
								has_country_flag = GER_IN_EXILE
							}
						}
						GER = {
						    annex_country = {
						        target = MGE
							    transfer_troops = no
						    }		

						    annex_country = {
							    target = GLF
							    transfer_troops = yes
						    }	
						
						    drop_cosmetic_tag = yes

						    remove_ideas = PB_GER_Cheap_Rifles
						    remove_ideas = PB_GER_Central_African_Bush_War
						    remove_ideas = PB_GER_Our_Darkest_Hour_7
						    remove_ideas = PB_GER_Our_Darkest_Hour_6
						    remove_ideas = PB_GER_Our_Darkest_Hour_5
						    remove_ideas = PB_GER_Our_Darkest_Hour_4
						    remove_ideas = PB_GER_Our_Darkest_Hour_3
						    remove_ideas = PB_GER_Our_Darkest_Hour_2
						    remove_ideas = PB_GER_Our_Darkest_Hour

						    transfer_state = 28
						    transfer_state = 42
						    transfer_state = 8
						    transfer_state = 909	
						    transfer_state = 923
						    transfer_state = 39
						    transfer_state = 736
						    transfer_state = 102
 
						    country_event = { id = germany_exile.8 days = 1 }	
						
						    set_capital = {
                                state = 55 
                                remember_old_capital = no
                            }
					    }
					}
					if = {
			            limit = {
				            PET = {
					            exists = yes
				           }
			            }
			            GER = {
				            set_country_flag = GER_Victory_In_Europe
			            }
		            }
					if = {
						limit = {
							GER = {
								is_in_faction_with = PEF
							}
						}
						GER = {
							set_global_flag = PEF_IN_FACTION_WITH_GER
						    dismantle_faction = yes
						}
					}
					if = {
						limit = {
							has_global_flag = PEF_IN_FACTION_WITH_GER
						}
						ENG = { 
							add_to_faction = PEF 
						}
					}
					if = {
						limit = {
							GER = {
								NOT = {
									is_in_faction_with = ENG
								}
							}
						}
						ENG = { 
							add_to_faction = GER 
						}
					}
					if = {
						limit = {
							ENG = {
								AND = {
									has_war_with = RUS
									GER = {
										NOT = {
											has_war_with = RUS
										}
									}

								}
							}
						}	
						ENG = {
							add_to_war = { 
                                targeted_alliance = GER 
                                enemy = RUS 
                                hostility_reason = asked_to_join
                            }
						}
					}
		        	set_global_flag = skip_default_capitulation
		        }

		        if = { #Second Great War - League Victory in Russia - Fallback in case Russia is fully capitulated before taking decision
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = ENG
		        				is_in_faction_with = ENG
		        			}
		        		}
						ROOT = {
							original_tag = RUS
						}
		        	}
					RUS = {
						leave_faction = yes
					}
		        	every_country = {
		        		limit = {
		        			has_war_with = RUS
		        		}
		        		white_peace = RUS
		        	}
		        	ENG = {
		        		country_event = { id = waroutcome.8 days = 1 } 
						set_country_flag = RUS_ENG_WW2_VICTOR
		        	}
					if = {
						limit = {
							ENG = {
								NOT = {
									has_war_with = FRA
								}
							}
						}
						set_country_flag = ENG_WW2_VICTOR
					}
		        	set_global_flag = skip_default_capitulation
		        }
        
        
		        if = { #Fall Of Britain
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = FRA
		        				is_in_faction_with = FRA
		        			}
		        		}
		        		ROOT = {
		        			original_tag = ENG
		        			is_in_faction_with = ENG
		        		}
        
		        	}
        
		        	every_country = {
		        		limit = {
		        			OR = {
		        				has_war_with = ENG
		        			}
		        		}
		        		white_peace = ENG
		        	}
		        	SPR = {
		        		transfer_state = 701
		        		transfer_state = 118
		        		annex_country = {
                            target = POR
                            transfer_troops = no
                        }
		        	}
		        	FRA = {
		        		set_country_flag = FRA_Cucked_Britain
		        		country_event = { id = occupation.1 days = 2 } 
		        		transfer_state = 131
		        		transfer_state = 116
		        	    transfer_state = 130
		        	    transfer_state = 132
		        	    transfer_state = 129
		        	    transfer_state = 128
		        	    transfer_state = 125
		        	    transfer_state = 126
		        	    transfer_state = 338
		        	    transfer_state = 127
		        	    transfer_state = 128
		        	    transfer_state = 123
		        		transfer_state = 121
		        	    transfer_state = 133
		            	transfer_state = 136
		            	transfer_state = 120
		        		transfer_state = 122
		        		if = {
		        			limit = {
								ICA = {
									is_in_faction_with = FRA	
								}
								transfer_state = 119
							}
		        		}
						if = {
		        			limit = {
								IRE = {
									is_in_faction_with = FRA	
								}
								transfer_state = 119
							}
		        		}
		        	}
        
		        	ENG = {
		        	    load_focus_tree = generic_focus
		        	}
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { #Mexico Fucks The Coalition
		        	limit = {
		        		FROM = {
		        			original_tag = MEX
		        		}
		        		ROOT = {
		        			OR = {
		        			    original_tag = RGD
		        				original_tag = TEX
		        				original_tag = SFE
		        				original_tag = CAL
		        			}
		        		}
		        	}
        
		        	every_country = {
		        		limit = {
		        			OR = {
		        				has_war_with = MEX
		        			}
		        		}
		        		white_peace = MEX
		        	}
		        	MEX = {
		        		news_event = { id = PBNews.119 days = 1 } 
		        		annex_country = {
		        			target = RGD
		        			transfer_troops = no
		        		}
		        		annex_country = {
		        			target = TEX
		        			transfer_troops = no
		        		}
		        		annex_country = {
		        			target = SFE
		        			transfer_troops = no
		        		}
		        		annex_country = {
		        			target = CAL
		        			transfer_troops = no
		        		}
		        	}
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { #Coalition Fucks Mexico
		        	limit = {
		        		FROM = {
		        			OR = {
		        			    original_tag = RGD
		        				original_tag = TEX
		        				original_tag = SFE
		        				original_tag = CAL
		        			}
		        		}
		        		ROOT = {
		        			original_tag = MEX
		        		}
        
		        	}
        
		        	every_country = {
		        		limit = {
		        			OR = {
		        				has_war_with = MEX
		        			}
		        		}
		        		white_peace = MEX
		        	}
		        	CAL = {
		        		news_event = { id = PBNews.120 days = 1 } 
		        		transfer_state = 484
		        	}
		        	TEX = {
		        		transfer_state = 903
		        		transfer_state = 908
		        		transfer_state = 907
		        	}
		        	483 = {
		        		set_demilitarized_zone = yes
		        	}
		        	482 = {
		        		set_demilitarized_zone = yes
		        	}
		        	481 = {
		        		set_demilitarized_zone = yes
		        	}
		        	MEX = {
		        		add_popularity = {
		        			ideology = cn
		        			popularity = 0.2
		        		}
		        		set_politics = {
		        			ruling_party = cn
		        			elections_allowed = yes
		        			last_election = "1933.01.01"
		        			election_frequency = 48
		        		}
		        	}
		        	set_global_flag = skip_default_capitulation
		        }
		        
		        if = { #Fall Of Germany
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = FRA
		        				is_in_faction_with = FRA
		        			}
		        		}
		        		ROOT = {
		        			original_tag = GER
		        		}
        
		        	}
        
		        	every_country = {
		        		limit = {
		        			has_war_with = GER
		        		}
		        		white_peace = GER
		        	}

					every_country = {
		        		limit = {
		        			has_war_with = DAS
		        		}
		        		white_peace = DAS
		        	}

					every_country = {
		        		limit = {
		        			has_war_with = DAF
		        		}
		        		white_peace = DAF
		        	}
		        	
					every_country = {
		        		limit = {
		        			has_war_with = SDW
		        		}
		        		white_peace = SDW
		        	}

		        	FRA = {
		        		if = {
		        			limit = {
		        				NOT = {
		        					has_global_flag = PB_GER_Defeated
		        				}
		        			}
		        			country_event = { id = germany.25 days = 1 } 
		        		}
						if = {
                            limit = {
                            	has_dlc = "La Resistance"
                            }
                            9 = {
                            	remove_dynamic_modifier = { modifier = czech_agitation }
                            }
                            75 = {
                            	remove_dynamic_modifier = { modifier = czech_agitation }
                            }
                            28 = {
                            	remove_dynamic_modifier = { modifier = french_terrorism }
                            }
                        }                             
		        		country_event = { id = French.95 days = 3 } 
		        		add_ideas = FRA_German_Liberation_Front_Presence_High
		        		set_country_flag = FRA_Cucked_Germany
		        		transfer_state = 28
		        		transfer_state = 917
		             	transfer_state = 42
		        	    transfer_state = 8
		            	transfer_state = 51
		        		transfer_state = 55
		        	    transfer_state = 54
		        	    transfer_state = 52
		        	    transfer_state = 153
		            	transfer_state = 152
		            	transfer_state = 4
		        	    transfer_state = 53
		            	transfer_state = 60
		            	transfer_state = 59
		            	transfer_state = 57
		            	transfer_state = 56
		            	transfer_state = 50
		        		transfer_state = 69
		        	    transfer_state = 9
		            	transfer_state = 75
		        	    transfer_state = 74
		        		transfer_state = 66
		            	transfer_state = 65
		        	    transfer_state = 68
		        	    transfer_state = 64
		            	transfer_state = 61
		        	    transfer_state = 62
		        	    transfer_state = 63
		        		transfer_state = 39
		        		transfer_state = 736
		        		transfer_state = 102
                        transfer_state = 909
		        		transfer_state = 923
						country_event = { 
							id = French_postwar.5
							days = 14
						}    	
		        	}
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { # Ireland Got Fucked
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = FRA
		        				is_in_faction_with = FRA
		        			}
		        		}
		        		ROOT = {
		        			original_tag = IRE
		        		}
		        	}
        
		        	FRA = {
		        		white_peace = ROOT
		        		annex_country = {
		        			target = ROOT
		        			transfer_troops = no
		        		}
		        	}
        
		        	IRE = {
		        		transfer_state = 135
		        		transfer_state = 113
		        		transfer_state = 134
		        	}
        
		        	IRE = {
		        		set_politics = {
	                        ruling_party = ni
                            elections_allowed = no
                            last_election = "1935.12.17"
                            election_frequency = 48
                        }
		        		set_cosmetic_tag = IRE_FRA_puppet
		        		remove_ideas = IRE_compromise 
		        		remove_ideas = IRE_first_colony
		        		remove_ideas = IRE_inexperienced_army
		        		remove_ideas = IRE_veterans_association
		        		remove_ideas = ENG_British_Economic_Sphere
		        	}
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { # Denmark Got Fucked
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = FRA
		        				is_in_faction_with = FRA
		        			}
		        		}
		        		ROOT = {
		        			original_tag = DEN
		        		}
		        	}
        
		        	FRA = {
		        		white_peace = ROOT
		        		annex_country = {
		        			target = ROOT
		        			transfer_troops = no
		        		}
		        		news_event = { 
		        			id = PBNews.152
		        			days = 1 
		        		} 
		        	}
        
		        	DEN = {
		        		if = {
		        			limit = {
		        				ENG = {
		        					has_war_with = FRA
		        				}
		        			}
		        			ENG = { 
		        				add_to_faction = DEN 
		        			}
		        		}
		        	}
        
		        	SCH = {
		        		transfer_state = 795
		        		transfer_state = 99
		        		transfer_state = 37
		        		transfer_state = 58
		        		set_capital = 37
		        	}
        
		        	FRA = {
		        	    if = {
		        		    limit = {
		        			    OR = {
		        				    has_dlc = "Together for Victory"
		        				    has_dlc = "Man the Guns"
		        			    }
		        		    }
        
		        		    set_autonomy = {
		        			    target = SCH
		        			    autonomous_state = autonomy_PB_Collaborator_State
		        			    freedom_level = 0.80
		        		    }
        
		        		    else = {
		        			    puppet = SCH
		        		    }
		        	    }
		            }
        
		        	795 = {
		        		add_core_of = SCH
		        	}
		        	99 = {
		        		add_core_of = SCH
		        	}
		        	37 = {
		        		add_core_of = SCH
		        	}
		        	58 = {
		        		add_core_of = SCH
		        	}
        
		        	SCH = {
		        		set_politics = {
	                        ruling_party = ni
                            elections_allowed = no
                        }
		        		add_popularity = {
                            ideology = ni
                            popularity = 1
                        }
		        		set_cosmetic_tag = SCH_FRA_Puppet
		        		kill_country_leader = yes
		        		create_country_leader = {
	                        name = "Kai Henning Bothildsen Nielsen"
	                        desc = "POLITICS_Kai_Nielsen_DESC"
	                        picture = "gfx/leaders/DEN/Portrait_DEN_Kai_Nielsen.dds"
	                        expire = "1965.1.1"
	                        ideology = NI_VARIANT_01
		        			traits = { 
		        			}
                        }
		        	}

					DEN = {
		        		set_cosmetic_tag = DEN_Exile
						transfer_state = 100
						transfer_state = 101
						transfer_state = 337
		        	}
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { # Sweden Got Fucked
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = FRA
		        				is_in_faction_with = FRA
		        			}
		        		}
		        		ROOT = {
		        			original_tag = SWE
		        		}
		        	}
        
		        	FRA = {
		        		white_peace = ROOT
		        		news_event = { 
		        			id = PBNews.154
		        			days = 1 
		        		} 
		        	}
        
		        	FRA = {
		        	    if = {
		        		    limit = {
		        			    OR = {
		        				    has_dlc = "Together for Victory"
		        				    has_dlc = "Man the Guns"
		        			    }
		        		    }
        
		        		    set_autonomy = {
		        			    target = SWE
		        			    autonomous_state = autonomy_PB_Collaborator_State
		        			    freedom_level = 0.80
		        		    }
        
		        		    else = {
		        			    puppet = SWE
		        		    }
		        	    }
		            }
        
		        	SWE = {
		        		set_politics = {
	                        ruling_party = ni
                            elections_allowed = no
                        }
		        		add_popularity = {
                            ideology = ni
                            popularity = 1
                        }
		        		set_cosmetic_tag = SWE_FRA_Puppet
		        		kill_country_leader = yes
		        		create_country_leader = {
	                        name = "Sven Olov Lindholm"
	                        desc = "POLITICS_Sven_Lindholm_DESC"
	                        picture = "gfx/leaders/SWE/Portrait_SWE_Sven_Lindholm.dds"
	                        expire = "1965.1.1"
	                        ideology = NI_VARIANT_01
		        			traits = { 
		        			}
                        }
		        	}
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { # Norway Got Fucked
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = FRA
		        				is_in_faction_with = FRA
		        			}
		        		}
		        		ROOT = {
		        			original_tag = NOR
		        		}
		        	}
        
		        	FRA = {
		        		white_peace = ROOT
		        		news_event = { 
		        			id = PBNews.153
		        			days = 1 
		        		} 
		        	}
        
		        	FRA = {
		        	    if = {
		        		    limit = {
		        			    OR = {
		        				    has_dlc = "Together for Victory"
		        				    has_dlc = "Man the Guns"
		        			    }
		        		    }
        
		        		    set_autonomy = {
		        			    target = NOR
		        			    autonomous_state = autonomy_PB_Collaborator_State
		        			    freedom_level = 0.80
		        		    }
        
		        		    else = {
		        			    puppet = NOR
		        		    }
		        	    }
		            }
        
		        	NOR = {
		        		remove_ideas = PB_NOR_Norwegian_Resistance
		        		set_politics = {
	                        ruling_party = ni
                            elections_allowed = no
                        }
		        		add_popularity = {
                            ideology = ni
                            popularity = 1
                        }
		        		set_cosmetic_tag = NOR_FRA_Puppet
		        		kill_country_leader = yes
		        		create_country_leader = {
	                        name = "Ragnar Sigvald Skancke"
	                        desc = "POLITICS_Sven_Lindholm_DESC"
	                        picture = "gfx/leaders/NOR/Portrait_NOR_Ragnar_Skancke.dds"
	                        expire = "1965.1.1"
	                        ideology = NI_VARIANT_01
		        			traits = { 
		        			}
                        }
		        	}
		        	set_global_flag = skip_default_capitulation
		        }

				if = { # IST Defeated
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = ENG
		        				is_in_faction_with = ENG
								original_tag = GER
		        				is_in_faction_with = GER
		        			}
		        		}
		        		ROOT = {
		        			original_tag = IST
		        		}
		        	}
        
		        	FROM = {
		        		white_peace = ROOT
		        	}

					ITA = {
						transfer_state = 832
						transfer_state = 158
						transfer_state = 831
						transfer_state = 834
						transfer_state = 159
						transfer_state = 162
						transfer_state = 835
						transfer_state = 160
						transfer_state = 161
						transfer_state = 157
						transfer_state = 2
						transfer_state = 833
						transfer_state = 117
						transfer_state = 156
						transfer_state = 115
						transfer_state = 114
					}

					# Replacing the above code with the annex command makes the news event for italy winning the civi war fire, gotta look at this another time

					ENG = { add_to_faction = ITA }
        
		        	set_global_flag = skip_default_capitulation
		        }

				if = { # ITA Defeated
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = FRA
		        				is_in_faction_with = FRA
		        			}
		        		}
		        		ROOT = {
		        			original_tag = ITA
		        		}
		        	}
        
		        	FROM = {
		        		white_peace = ROOT
		        	}

					IST = {
						transfer_state = 832
						transfer_state = 158
						transfer_state = 831
						transfer_state = 834
						transfer_state = 159
						transfer_state = 162
						transfer_state = 835
						transfer_state = 160
						transfer_state = 161
						transfer_state = 157
						transfer_state = 2
						transfer_state = 833
						transfer_state = 117
						transfer_state = 156
						transfer_state = 115
						transfer_state = 114

						set_cosmetic_tag = ITA_IST_Victory
					}

					# Replacing the above code with the annex command makes the news event for italy winning the civi war fire, gotta look at this another time

					FRA = { 
						add_to_faction = IST 
					}
        
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { # IST Victory In Civil War
		        	limit = {
		        		FROM = {
		        			original_tag = IST
		        		}
		        		ROOT = {
		        			original_tag = ITA
		        		}
		        	}
        
		        	IST = {
						set_cosmetic_tag = ITA_IST_Victory
		        		white_peace = ROOT
		        		annex_country = {
		        			target = ROOT
		        			transfer_troops = no
		        		}
						remove_ideas = PB_IST_Last_Leg
		        		news_event = { 
		        			id = PBNews.122
		        			days = 1 
		        		} 
						country_event = { 
		        			id = Italian.1
		        			days = 5
		        		} 
		        	}
        
		        	set_global_flag = skip_default_capitulation
		        }
        
		        if = { # ITA Victory In Civil War
		        	limit = {
		        		FROM = {
		        			original_tag = ITA
		        		}
		        		ROOT = {
		        			original_tag = IST
		        		}
		        	}
        
		        	ITA = {
		        		remove_ideas = PB_ITA_treaty_of_anzio
						remove_ideas = PB_ITA_Considerable_Political_Violence
		        		white_peace = ROOT
		        		annex_country = {
		        			target = ROOT
		        			transfer_troops = no
		        		}
		        		news_event = { 
		        			id = PBNews.121
		        			days = 1 
		        		} 
						country_event = { 
		        			id = Italian.3
		        			days = 5
		        		} 
		        	}
        
		        	set_global_flag = skip_default_capitulation
		        }

		        if = { # Russian Finland Defeated
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = ENG
		        				is_in_faction_with = ENG
		        			}
		        		}
		        		ROOT = {
		        			original_tag = FIN
		        		}
		        	}
        
					FFI = {
						annex_country = {
							target = FIN
						}	
					}

					ENG = {
						add_to_faction = FFI
					}

		        	set_global_flag = skip_default_capitulation
		        }

		        if = { # Spain Got Fucked
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = ENG
		        				is_in_faction_with = ENG
		        			}
		        		}
		        		ROOT = {
		        			original_tag = SPR
		        		}
		        	}
        
					SPR = {
						leave_faction = yes
					}

		        	ENG = {
		        		white_peace = SPR
		        	}

		        	ENG = {
						country_event = { 
		        			id = waroutcome.13
		        		} 
		        	}

		        	set_global_flag = skip_default_capitulation
		        }

		        if = { # Portugal Got Fucked
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = SPR
		        				is_in_faction_with = SPR
		        			}
		        		}
		        		ROOT = {
		        			original_tag = POR
		        		}
		        	}
        
		        	SPR = {
						country_event = { 
		        			id = waroutcome.14
		        		} 
		        	}

		        	set_global_flag = skip_default_capitulation
		        }

		        if = { # North Vietnam Defeated
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = ENG
		        				is_in_faction_with = ENG
		        			}
		        		}
		        		ROOT = {
		        			original_tag = VIN
		        		}
		        	}
        
					BFE = {
						annex_country = {
							target = VIN
						}	
					}

		        	ENG = {
						country_event = { 
		        			id = waroutcome.18
							days = 1
		        		} 
		        	}

					VIN = {
						remove_idea = PB_Idea_VIN_Rebellion
					}

					news_event = {
						id = PBNews.31
					}

		        	set_global_flag = skip_default_capitulation
		        }

		        if = { # Ecuador Revolution Defeated
		        	limit = {
		        		FROM = {
		        			original_tag = NWG
		        		}
		        		ROOT = {
		        			original_tag = ECU
		        		}
		        	}
        
					NWG = {
						white_peace = ECU
						annex_country = {
							target = ECU
						}	
					}

		        	set_global_flag = skip_default_capitulation
		        }

		        if = { # Ecuador Revolution Succeeds
		        	limit = {
		        		FROM = {
		        			original_tag = ECU
		        		}
		        		ROOT = {
		        			original_tag = NEW
		        		}
		        	}
        
		        	NWG = {
		        		white_peace = ECU
		        	}

		        	set_global_flag = skip_default_capitulation
		        }
		        if = { # Russian Loyalists Defeated
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = DRU
		        				original_tag = RRU
		        			}
		        		}
		        		ROOT = {
		        			original_tag = NRU
		        		}
		        	}
        
					DRU = {
						white_peace = NRU
						annex_country = {
							target = NRU
						}	
						country_event = { 
		        			id = waroutcome.19
							days = 5
		        		} 
					}

		        	set_global_flag = skip_default_capitulation
		        }
		        if = { # Russian Loyalist Victories - Democrats
		        	limit = {
		        		FROM = {
							original_tag = NRU
		        		}
		        		ROOT = {
							original_tag = DRU
		        		}
		        	}
        
					NRU = {
						annex_country = {
							target = ROOT
						}	
					}

		        	set_global_flag = skip_default_capitulation
		        }
		        if = { # Russian Loyalist Victories - Anarchists
		        	limit = {
		        		FROM = {
							original_tag = NRU
		        		}
		        		ROOT = {
							original_tag = RRU
		        		}
		        	}
        
					RRU = {
						annex_country = {
							target = ROOT
						}	
					}

		        	set_global_flag = skip_default_capitulation
		        }
		        if = { # Russian Democrat Victory against Anarchists
		        	limit = {
		        		FROM = {
							original_tag = DRU
		        		}
		        		ROOT = {
							original_tag = RRU
		        		}
		        	}
        
					DRU = {
						annex_country = {
							target = ROOT
						}

						set_cosmetic_tag = DRU_Victory	
					}

		        	set_global_flag = skip_default_capitulation
		        }
		        if = { # Russian Anarchist Victory against Democrats
		        	limit = {
		        		FROM = {
							original_tag = RRU
		        		}
		        		ROOT = {
							original_tag = DRU
		        		}
		        	}
        
					RRU = {
						annex_country = {
							target = ROOT
						}

						set_cosmetic_tag = RRU_Victory	
					}

		        	set_global_flag = skip_default_capitulation
		        }
		        if = { # Resurgent Loyalists Defeated by League
		        	limit = {
		        		FROM = {
		        			OR = {
		        				original_tag = ENG
		        				is_in_faction_with = ENG
		        			}
		        		}
		        		ROOT = {
		        			original_tag = NRU
		        		}
		        	}
        
					MOS = {
						annex_country = {
							target = NRU
						}	

						set_cosmetic_tag = RUS_League_Mandate
					}

		        	ENG = {
						country_event = { 
		        			id = waroutcome.20
							days = 1
		        		} 
		        	}
					
		        	set_global_flag = skip_default_capitulation
		        }
		        #Capitulation block
		        set_global_flag = war_continuing
	        }            
	        clr_global_flag = skip_default_capitulation
	    }
    }
	#Armchair historian of wars
	on_declare_war = {
		effect = {
			log="[GetDateText]: [Root.GetName] declared war on [From.GetName]"
		}
	}
}